<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>&#x5fae;&#x4fe1;&#x5c0f;&#x7a0b;&#x5e8f;&#x5f00;&#x53d1;&#x89c4;&#x8303;&#x8be6;&#x89e3;</title>
  <style>
    /* From extension vscode.github */
    /*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

    .vscode-dark img[src$=\#gh-light-mode-only],
    .vscode-light img[src$=\#gh-dark-mode-only],
    .vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
    .vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
      display: none;
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
  <link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet"
    type="text/css">
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
      font-size: 14px;
      line-height: 1.6;
    }
  </style>
  <style>
    .task-list-item {
      list-style-type: none;
    }

    .task-list-item-checkbox {
      margin-left: -20px;
      vertical-align: middle;
      pointer-events: none;
    }
  </style>
  <style>
    :root {
      --color-note: #0969da;
      --color-tip: #1a7f37;
      --color-warning: #9a6700;
      --color-severe: #bc4c00;
      --color-caution: #d1242f;
      --color-important: #8250df;
    }
  </style>
  <style>
    @media (prefers-color-scheme: dark) {
      :root {
        --color-note: #2f81f7;
        --color-tip: #3fb950;
        --color-warning: #d29922;
        --color-severe: #db6d28;
        --color-caution: #f85149;
        --color-important: #a371f7;
      }
    }
  </style>
  <style>
    .markdown-alert {
      padding: 0.5rem 1rem;
      margin-bottom: 16px;
      color: inherit;
      border-left: .25em solid #888;
    }

    .markdown-alert>:first-child {
      margin-top: 0
    }

    .markdown-alert>:last-child {
      margin-bottom: 0
    }

    .markdown-alert .markdown-alert-title {
      display: flex;
      font-weight: 500;
      align-items: center;
      line-height: 1
    }

    .markdown-alert .markdown-alert-title .octicon {
      margin-right: 0.5rem;
      display: inline-block;
      overflow: visible !important;
      vertical-align: text-bottom;
      fill: currentColor;
    }

    .markdown-alert.markdown-alert-note {
      border-left-color: var(--color-note);
    }

    .markdown-alert.markdown-alert-note .markdown-alert-title {
      color: var(--color-note);
    }

    .markdown-alert.markdown-alert-important {
      border-left-color: var(--color-important);
    }

    .markdown-alert.markdown-alert-important .markdown-alert-title {
      color: var(--color-important);
    }

    .markdown-alert.markdown-alert-warning {
      border-left-color: var(--color-warning);
    }

    .markdown-alert.markdown-alert-warning .markdown-alert-title {
      color: var(--color-warning);
    }

    .markdown-alert.markdown-alert-tip {
      border-left-color: var(--color-tip);
    }

    .markdown-alert.markdown-alert-tip .markdown-alert-title {
      color: var(--color-tip);
    }

    .markdown-alert.markdown-alert-caution {
      border-left-color: var(--color-caution);
    }

    .markdown-alert.markdown-alert-caution .markdown-alert-title {
      color: var(--color-caution);
    }
  </style>

</head>

<body class="vscode-body vscode-light">
  <h1 id="微信小程序开发规范详解">微信小程序开发规范详解</h1>
  <h2 id="目录">目录</h2>
  <ol>
    <li><a href="#%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83">代码结构规范</a></li>
    <li><a href="#%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83">命名规范</a></li>
    <li><a href="#wxml%E8%A7%86%E5%9B%BE%E5%B1%82%E8%A7%84%E8%8C%83">WXML 视图层规范</a></li>
    <li><a href="#api%E8%B0%83%E7%94%A8%E8%A7%84%E8%8C%83">API 调用规范</a></li>
    <li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E8%A7%84%E8%8C%83">数据绑定规范</a></li>
    <li><a href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%A7%84%E8%8C%83">性能优化规范</a></li>
    <li><a href="#%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E8%A7%84%E8%8C%83">代码质量规范</a></li>
    <li><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">最佳实践</a></li>
  </ol>
  <hr>
  <h2 id="代码结构规范">代码结构规范</h2>
  <h3 id="页面文件结构">页面文件结构</h3>
  <p><strong>规则</strong>: 页面文件应遵循一致的结构：导入 -&gt; 常量 -&gt; Page 定义 -&gt; 数据 -&gt; 生命周期函数 -&gt; 事件处理函数</p>
  <p><strong>说明</strong>: 良好的文件结构可以提高代码可读性和维护性。Page 对象内的属性应遵循特定顺序，方便团队成员快速定位代码位置。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 导入部分</span>
<span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../utils/request&#x27;</span>;
<span class="hljs-keyword">import</span> { formatTime } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../utils/util&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">API_URL</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../config/api&#x27;</span>;

<span class="hljs-comment">// 常量定义</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_LIMIT</span> = <span class="hljs-number">10</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PAGE_TITLE</span> = <span class="hljs-string">&#x27;首页&#x27;</span>;

<span class="hljs-comment">// Page对象定义，按规范顺序排列属性</span>
<span class="hljs-title class_">Page</span>({
  <span class="hljs-comment">// 数据定义</span>
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">list</span>: [],
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">hasMore</span>: <span class="hljs-literal">true</span>,
  },

  <span class="hljs-comment">// 生命周期函数，按执行顺序排列</span>
  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchData</span>(options.<span class="hljs-property">id</span>);
  },

  <span class="hljs-title function_">onShow</span>(<span class="hljs-params"></span>) {
    wx.<span class="hljs-title function_">setNavigationBarTitle</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-variable constant_">PAGE_TITLE</span>,
    });
  },

  <span class="hljs-title function_">onReady</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 页面首次渲染完成后执行</span>
  },

  <span class="hljs-title function_">onHide</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 页面隐藏时执行</span>
  },

  <span class="hljs-title function_">onUnload</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 清理定时器等资源</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>);
    }
  },

  <span class="hljs-title function_">onPullDownRefresh</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshData</span>();
  },

  <span class="hljs-title function_">onReachBottom</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadMoreData</span>();
  },

  <span class="hljs-comment">// 事件处理函数</span>
  <span class="hljs-title function_">handleItemTap</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-keyword">const</span> { id } = e.<span class="hljs-property">currentTarget</span>.<span class="hljs-property">dataset</span>;
    wx.<span class="hljs-title function_">navigateTo</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/detail/detail?id=<span class="hljs-subst">${id}</span>`</span>,
    });
  },

  <span class="hljs-comment">// 业务方法</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params">id</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span> });
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/api/items/<span class="hljs-subst">${id}</span>`</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">list</span>: result.<span class="hljs-property">data</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      });
    } <span class="hljs-keyword">catch</span> (err) {
      wx.<span class="hljs-title function_">showToast</span>({
        <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;数据加载失败&#x27;</span>,
        <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;none&#x27;</span>,
      });
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });
    }
  },
});
</code></pre>
  <h3 id="导入顺序规则">导入顺序规则</h3>
  <p><strong>规则</strong>: 导入应按照以下顺序：第三方库 -&gt; 工具函数 -&gt; 配置 -&gt; 服务 -&gt; 组件</p>
  <p><strong>说明</strong>: 统一的导入顺序使代码更加整洁，遵循从外到内、从通用到特定的原则。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 第三方库</span>
<span class="hljs-keyword">import</span> regeneratorRuntime <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;regenerator-runtime&#x27;</span>;
<span class="hljs-keyword">import</span> dayjs <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/lib/dayjs&#x27;</span>;

<span class="hljs-comment">// 工具函数</span>
<span class="hljs-keyword">import</span> { debounce, throttle } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../utils/performance&#x27;</span>;
<span class="hljs-keyword">import</span> { formatPrice, formatDate } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../utils/formatter&#x27;</span>;

<span class="hljs-comment">// 配置</span>
<span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">API_ENDPOINTS</span>, <span class="hljs-variable constant_">APP_CONFIG</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../config/index&#x27;</span>;

<span class="hljs-comment">// 服务</span>
<span class="hljs-keyword">import</span> userService <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../services/userService&#x27;</span>;
<span class="hljs-keyword">import</span> paymentService <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../services/paymentService&#x27;</span>;

<span class="hljs-comment">// 组件</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Dialog</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../components/dialog/dialog&#x27;</span>;
</code></pre>
  <h3 id="组件文件结构">组件文件结构</h3>
  <p><strong>规则</strong>: 组件文件应遵循一致的结构</p>
  <p><strong>说明</strong>: 与页面文件类似，组件文件也应该有清晰的属性顺序，遵循先声明后使用的原则。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Component</span>({
  <span class="hljs-comment">// 组件的对外属性</span>
  <span class="hljs-attr">properties</span>: {
    <span class="hljs-attr">title</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    },
    <span class="hljs-attr">showIcon</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-literal">false</span>,
    },
  },

  <span class="hljs-comment">// 组件选项</span>
  <span class="hljs-attr">options</span>: {
    <span class="hljs-attr">styleIsolation</span>: <span class="hljs-string">&#x27;isolated&#x27;</span>,
    <span class="hljs-attr">multipleSlots</span>: <span class="hljs-literal">true</span>,
  },

  <span class="hljs-comment">// 组件外部样式类</span>
  <span class="hljs-attr">externalClasses</span>: [<span class="hljs-string">&#x27;custom-class&#x27;</span>],

  <span class="hljs-comment">// 组件的内部数据</span>
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span>,
  },

  <span class="hljs-comment">// 组件生命周期</span>
  <span class="hljs-attr">lifetimes</span>: {
    <span class="hljs-title function_">attached</span>(<span class="hljs-params"></span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
    },
    <span class="hljs-title function_">detached</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 资源清理</span>
    },
  },

  <span class="hljs-comment">// 组件所在页面的生命周期</span>
  <span class="hljs-attr">pageLifetimes</span>: {
    <span class="hljs-title function_">show</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 页面被展示时执行</span>
    },
    <span class="hljs-title function_">hide</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 页面被隐藏时执行</span>
    },
  },

  <span class="hljs-comment">// 数据监听器</span>
  <span class="hljs-attr">observers</span>: {
    <span class="hljs-attr">title</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">title</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateTitle</span>(title);
    },
  },

  <span class="hljs-comment">// 组件方法</span>
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 初始化逻辑</span>
    },

    <span class="hljs-title function_">handleTap</span>(<span class="hljs-params"></span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">active</span>: !<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">active</span>,
      });

      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;tap&#x27;</span>, {
        <span class="hljs-attr">active</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">active</span>,
      });
    },
  },
});
</code></pre>
  <hr>
  <h2 id="命名规范">命名规范</h2>
  <h3 id="变量命名规范">变量命名规范</h3>
  <p><strong>规则</strong>: 变量命名应使用驼峰式(camelCase)</p>
  <p><strong>说明</strong>: 遵循 JavaScript 社区的通用命名规范，变量名应描述其用途，且首字母小写。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">const</span> userName = <span class="hljs-string">&#x27;John&#x27;</span>;
<span class="hljs-keyword">let</span> pageIndex = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> isLoading = <span class="hljs-literal">false</span>;
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">UserName</span> = <span class="hljs-string">&#x27;John&#x27;</span>; <span class="hljs-comment">// 首字母大写，不符合变量命名规范</span>
<span class="hljs-keyword">let</span> page_index = <span class="hljs-number">1</span>; <span class="hljs-comment">// 使用下划线分隔，不符合驼峰命名</span>
<span class="hljs-keyword">let</span> loading = <span class="hljs-literal">false</span>; <span class="hljs-comment">// 名称不够描述性</span>
</code></pre>
  <h3 id="常量命名规范">常量命名规范</h3>
  <p><strong>规则</strong>: 常量应使用全大写下划线分隔(UPPER_SNAKE_CASE)</p>
  <p><strong>说明</strong>: 常量值在程序运行期间不应更改，使用全大写命名可以清晰地将其与变量区分开。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_BASE_URL</span> = <span class="hljs-string">&#x27;https://api.example.com&#x27;</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_RETRY_COUNT</span> = <span class="hljs-number">3</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_TIMEOUT</span> = <span class="hljs-number">5000</span>;
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">const</span> apiBaseUrl = <span class="hljs-string">&#x27;https://api.example.com&#x27;</span>; <span class="hljs-comment">// 应使用全大写</span>
<span class="hljs-keyword">const</span> maxRetryCount = <span class="hljs-number">3</span>; <span class="hljs-comment">// 应使用全大写</span>
</code></pre>
  <h3 id="异步函数命名规范">异步函数命名规范</h3>
  <p><strong>规则</strong>: 异步函数应使用 async 前缀或 fetch/load/get 等动词开头</p>
  <p><strong>说明</strong>: 通过命名立即表明函数是异步的，方便使用者了解函数的执行特性。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUserInfo</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">/* ... */</span>
}
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadPageData</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">/* ... */</span>
}
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserProfile</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">/* ... */</span>
}
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">asyncUpdateStatus</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">/* ... */</span>
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">userInfo</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">/* ... */</span>
} <span class="hljs-comment">// 缺少适当前缀</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">pageData</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">/* ... */</span>
} <span class="hljs-comment">// 缺少适当前缀</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">/* ... */</span>
} <span class="hljs-comment">// 不明确是异步操作</span>
</code></pre>
  <h3 id="事件处理函数命名规范">事件处理函数命名规范</h3>
  <p><strong>规则</strong>: 事件处理函数应使用 handle/on 前缀</p>
  <p><strong>说明</strong>: 清晰地表明函数是用于处理事件的，并暗示该函数会被其他函数或组件调用。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleSubmit</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">/* ... */</span>
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">onTapButton</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">/* ... */</span>
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleImageLoad</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">/* ... */</span>
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">submit</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">/* ... */</span>
} <span class="hljs-comment">// 缺少handle/on前缀</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">tapButton</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">/* ... */</span>
} <span class="hljs-comment">// 缺少handle/on前缀</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">imageLoad</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">/* ... */</span>
} <span class="hljs-comment">// 缺少handle/on前缀</span>
</code></pre>
  <h3 id="自定义事件命名规范">自定义事件命名规范</h3>
  <p><strong>规则</strong>: 自定义事件名应使用 kebab-case</p>
  <p><strong>说明</strong>: 视图层使用 kebab-case 命名事件与 HTML 规范保持一致，提高代码的可读性。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 在组件中触发事件</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;item-tap&#x27;</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span> });
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;load-more&#x27;</span>, { <span class="hljs-attr">page</span>: <span class="hljs-number">2</span> });
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;value-change&#x27;</span>, { <span class="hljs-attr">value</span>: newValue });
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 错误的事件命名</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;itemTap&#x27;</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span> }); <span class="hljs-comment">// 应使用kebab-case</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;LoadMore&#x27;</span>, { <span class="hljs-attr">page</span>: <span class="hljs-number">2</span> }); <span class="hljs-comment">// 首字母大写且使用驼峰</span>
</code></pre>
  <h3 id="视图层类名命名规范">视图层类名命名规范</h3>
  <p><strong>规则</strong>: WXML 中的 class 名应使用 kebab-case</p>
  <p><strong>说明</strong>: 与 HTML 标准保持一致，使用连字符分隔单词，全部小写。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user-card&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user-avatar-container&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user-avatar&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;{{avatarUrl}}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user-info&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user-name&quot;</span>&gt;</span>{{userName}}<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user-description&quot;</span>&gt;</span>{{description}}<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;userCard&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 应使用user-card --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;avatarContainer&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 应使用avatar-container --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;userAvatar&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;{{avatarUrl}}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 应使用user-avatar --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <hr>
  <h2 id="wxml-视图层规范">WXML 视图层规范</h2>
  <h3 id="必须指定-wxkey">必须指定 wx:key</h3>
  <p><strong>规则</strong>: 使用 wx:for 时必须指定 wx:key 以提高性能</p>
  <p><strong>说明</strong>: wx:key 帮助微信小程序框架跟踪哪些项目改变，有助于提高列表渲染性能和重用 DOM 元素。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 当列表项本身是字符串或数字时 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{simpleList}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;*this&quot;</span>&gt;</span> {{item}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h3 id="避免-wxif-与-wxfor-同用">避免 wx:if 与 wx:for 同用</h3>
  <p><strong>规则</strong>: wx:if 与 wx:for 不应用于同一元素</p>
  <p><strong>说明</strong>: 当 wx:if 和 wx:for 同时存在时，wx:for 优先级高，这可能导致不必要的遍历过程浪费性能。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 使用block包装wx:for，在内部元素使用wx:if --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">block</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{item.visible}}&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">block</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 或预先过滤数据 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{filteredList}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{item.visible}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h3 id="使用-wxfor-item-自定义变量名">使用 wx:for-item 自定义变量名</h3>
  <p><strong>规则</strong>: 当嵌套使用 wx:for 时应自定义 item 名称</p>
  <p><strong>说明</strong>: 嵌套循环中，内外层默认都使用 item 作为迭代变量，容易引起混淆和错误。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{departments}}&quot;</span> <span class="hljs-attr">wx:for-item</span>=<span class="hljs-string">&quot;department&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>部门：{{department.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{department.employees}}&quot;</span> <span class="hljs-attr">wx:for-item</span>=<span class="hljs-string">&quot;employee&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
    员工：{{employee.name}}
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{departments}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>部门：{{item.name}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{item.employees}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 内层的item会覆盖外层的item，可能导致错误 --&gt;</span>
    员工：{{item.name}}
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h3 id="使用-wxfor-index-自定义索引名">使用 wx:for-index 自定义索引名</h3>
  <p><strong>规则</strong>: 当嵌套使用 wx:for 时应自定义 index 名称</p>
  <p><strong>说明</strong>: 类似于 item 问题，嵌套循环中的索引也应当自定义命名，避免命名冲突。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:for-index</span>=<span class="hljs-string">&quot;outerIndex&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{item.subItems}}&quot;</span> <span class="hljs-attr">wx:for-index</span>=<span class="hljs-string">&quot;innerIndex&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
    外层索引：{{outerIndex}}，内层索引：{{innerIndex}}
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{item.subItems}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- index会被内层循环覆盖 --&gt;</span>
    外层索引：{{index}}，内层索引：{{index}}
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h3 id="避免滥用-scroll-view">避免滥用 scroll-view</h3>
  <p><strong>规则</strong>: 不要在 scroll-view 中嵌套 scroll-view</p>
  <p><strong>说明</strong>: 嵌套使用 scroll-view 会导致滚动行为异常和性能问题。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 分离不同方向的scroll-view --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">scroll-view</span> <span class="hljs-attr">scroll-y</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;vertical-scroll&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 内容 --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">scroll-view</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">scroll-view</span> <span class="hljs-attr">scroll-x</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;horizontal-scroll&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 内容 --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">scroll-view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">scroll-view</span> <span class="hljs-attr">scroll-y</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;vertical-scroll&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scroll-view</span> <span class="hljs-attr">scroll-x</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;horizontal-scroll&quot;</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- 内容 --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">scroll-view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">scroll-view</span>&gt;</span>
</code></pre>
  <h3 id="推荐使用-catchtap-代替-bindtap">推荐使用 catchtap 代替 bindtap</h3>
  <p><strong>规则</strong>: 事件冒泡可能导致意外行为，推荐使用 catchtap</p>
  <p><strong>说明</strong>: catchtap 会阻止事件冒泡，避免父元素也响应点击事件，防止多次触发或触发不应响应的事件。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;outer&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;handleInnerTap&quot;</span>&gt;</span> 点击内部 <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;outer&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;handleOuterTap&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;inner&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;handleInnerTap&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 点击内部会同时触发handleInnerTap和handleOuterTap --&gt;</span>
    点击内部
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h3 id="图片使用懒加载">图片使用懒加载</h3>
  <p><strong>规则</strong>: 图片应使用懒加载提高性能</p>
  <p><strong>说明</strong>: 懒加载可以减少初始加载时间，提高页面打开速度，特别是对于有多张图片的长列表页面。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">lazy-load</span>=<span class="hljs-string">&quot;{{true}}&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;{{imageUrl}}&quot;</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">&quot;aspectFill&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;{{imageUrl}}&quot;</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">&quot;aspectFill&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
</code></pre>
  <h3 id="按钮使用-type-和-size">按钮使用 type 和 size</h3>
  <p><strong>规则</strong>: 按钮应指定类型和大小</p>
  <p><strong>说明</strong>: 明确指定按钮类型和大小，可以提高 UI 一致性和用户体验。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;handleSubmit&quot;</span>&gt;</span>提交<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;default&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;handleCancel&quot;</span>&gt;</span>取消<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;handleSubmit&quot;</span>&gt;</span>提交<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
  <h3 id="表单项添加-placeholder">表单项添加 placeholder</h3>
  <p><strong>规则</strong>: 输入框应添加 placeholder</p>
  <p><strong>说明</strong>: placeholder 提示用户应输入的内容类型，提高表单的可用性。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入用户名&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{{username}}&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入留言内容&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{{message}}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{{username}}&quot;</span> /&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{{message}}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
</code></pre>
  <h3 id="使用-slot-增强组件可定制性">使用 slot 增强组件可定制性</h3>
  <p><strong>规则</strong>: 复杂组件应提供 slot 插槽</p>
  <p><strong>说明</strong>: 插槽可以增强组件的灵活性和复用性，允许父组件注入自定义内容。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 组件定义 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card-header&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;header&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card-content&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card-footer&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;footer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 组件使用 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">my-card</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&quot;header&quot;</span>&gt;</span>自定义标题<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>主要内容<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&quot;footer&quot;</span>&gt;</span>自定义底部<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">my-card</span>&gt;</span>
</code></pre>
  <h3 id="条件渲染使用-block">条件渲染使用 block</h3>
  <p><strong>规则</strong>: 多元素条件渲染应使用 block</p>
  <p><strong>说明</strong>: block 是一个不会渲染的容器，可以用于包裹多个元素进行统一条件渲染，避免额外嵌套。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">block</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{isLoggedIn}}&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;welcome&quot;</span>&gt;</span>欢迎回来，{{username}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;last-login&quot;</span>&gt;</span>上次登录：{{lastLoginTime}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">block</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">block</span> <span class="hljs-attr">wx:else</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;login-tip&quot;</span>&gt;</span>请先登录<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;handleLogin&quot;</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">block</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{isLoggedIn}}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;welcome&quot;</span>&gt;</span>欢迎回来，{{username}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{isLoggedIn}}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;last-login&quot;</span>&gt;</span>上次登录：{{lastLoginTime}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{!isLoggedIn}}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;login-tip&quot;</span>&gt;</span>请先登录<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{!isLoggedIn}}&quot;</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">&quot;handleLogin&quot;</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
  <h3 id="空状态处理">空状态处理</h3>
  <p><strong>规则</strong>: 列表应处理空状态</p>
  <p><strong>说明</strong>: 良好的空状态处理可以提升用户体验，明确告知用户当前无数据的情况。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">block</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{list.length &gt; 0}}&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;list-item&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">block</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty-state&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/images/empty.png&quot;</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">&quot;heightFix&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty-image&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty-text&quot;</span>&gt;</span>暂无数据<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;list-item&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-comment">&lt;!-- 当list为空时，界面上什么都不显示，用户体验不佳 --&gt;</span>
</code></pre>
  <h3 id="使用-hover-class">使用 hover-class</h3>
  <p><strong>规则</strong>: 可点击元素应有点击反馈</p>
  <p><strong>说明</strong>: 点击反馈可以提供良好的用户交互体验，让用户知道元素是可点击的。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">hover-class</span>=<span class="hljs-string">&quot;hover-class&quot;</span> <span class="hljs-attr">hover-stay-time</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;handleTap&quot;</span>&gt;</span> 点击我 <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 在WXSS中定义hover-class样式 --&gt;</span>
<span class="hljs-comment">&lt;!--
.hover-class {
  opacity: 0.8;
  background-color: #f0f0f0;
}
--&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;handleTap&quot;</span>&gt;</span> 点击我 <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-comment">&lt;!-- 缺少视觉反馈 --&gt;</span>
</code></pre>
  <h3 id="使用-wxs-优化">使用 wxs 优化</h3>
  <p><strong>规则</strong>: 复杂表达式应使用 wxs</p>
  <p><strong>说明</strong>: WXS 可以在视图层直接运行，减少逻辑层和视图层的通信，优化性能。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- wxs文件 format.wxs --&gt;</span>
<span class="hljs-comment">&lt;!--
module.exports = {
  formatPrice: function(price) {
    return &#x27;¥&#x27; + price.toFixed(2);
  },
  formatDate: function(timestamp) {
    var date = getDate(timestamp);
    return date.getFullYear() + &#x27;-&#x27; + (date.getMonth() + 1) + &#x27;-&#x27; + date.getDate();
  }
};
--&gt;</span>

<span class="hljs-comment">&lt;!-- 页面中使用 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">wxs</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../../utils/format.wxs&quot;</span> <span class="hljs-attr">module</span>=<span class="hljs-string">&quot;format&quot;</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;price&quot;</span>&gt;</span>{{format.formatPrice(product.price)}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;date&quot;</span>&gt;</span>{{format.formatDate(order.createTime)}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 在WXML中使用复杂表达式 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;price&quot;</span>&gt;</span>¥{{product.price.toFixed(2)}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;date&quot;</span>
  &gt;</span>{{order.createTime.getFullYear()}}-{{order.createTime.getMonth() +
  1}}-{{order.createTime.getDate()}}&lt;/view
&gt;
</code></pre>
  <hr>
  <h2 id="api-调用规范">API 调用规范</h2>
  <h3 id="微信小程序-api-调用方式">微信小程序 API 调用方式</h3>
  <p><strong>规则</strong>: 推荐使用 Promise 封装的 API 调用方式</p>
  <p><strong>说明</strong>: Promise 风格的 API 调用可以简化异步代码，避免回调地狱，提高代码可读性。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 使用Promise封装</span>
<span class="hljs-keyword">import</span> { wxPromise } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../utils/wx-promise&#x27;</span>;

<span class="hljs-comment">// 调用方式</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> wxPromise.<span class="hljs-title function_">request</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
      <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,
    });

    <span class="hljs-comment">// 处理成功结果</span>
    <span class="hljs-keyword">return</span> res.<span class="hljs-property">data</span>;
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-comment">// 错误处理</span>
    wx.<span class="hljs-title function_">showToast</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;请求失败&#x27;</span>,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;none&#x27;</span>,
    });
  }
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 回调式API调用</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
  wx.<span class="hljs-title function_">request</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,
    <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
      <span class="hljs-comment">// 处理成功结果</span>
    },
    <span class="hljs-attr">fail</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
      <span class="hljs-comment">// 错误处理</span>
    },
  });
}
</code></pre>
  <h3 id="api-调用错误处理">API 调用错误处理</h3>
  <p><strong>规则</strong>: wx.api 调用应包含完整的错误处理</p>
  <p><strong>说明</strong>: 完整的错误处理可以提高应用的稳定性和用户体验，及时处理异常情况。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript">wx.<span class="hljs-title function_">request</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
  <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
    <span class="hljs-comment">// 处理成功响应</span>
  },
  <span class="hljs-attr">fail</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
    <span class="hljs-comment">// 错误处理</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;请求失败:&#x27;</span>, err);
    wx.<span class="hljs-title function_">showToast</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;网络错误，请重试&#x27;</span>,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;none&#x27;</span>,
    });
  },
  <span class="hljs-attr">complete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 无论成功失败都会执行</span>
    wx.<span class="hljs-title function_">hideLoading</span>();
  },
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript">wx.<span class="hljs-title function_">request</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
  <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
    <span class="hljs-comment">// 处理成功响应</span>
  },
  <span class="hljs-comment">// 缺少fail回调</span>
});
</code></pre>
  <h3 id="防止重复页面跳转">防止重复页面跳转</h3>
  <p><strong>规则</strong>: 页面跳转前应防止重复点击</p>
  <p><strong>说明</strong>: 快速多次点击可能导致重复跳转，引起页面栈异常或重复加载资源。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">isNavigating</span>: <span class="hljs-literal">false</span>,
  },

  <span class="hljs-title function_">navigateToDetail</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-comment">// 防止重复点击</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">isNavigating</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> { id } = e.<span class="hljs-property">currentTarget</span>.<span class="hljs-property">dataset</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">isNavigating</span>: <span class="hljs-literal">true</span> });

    wx.<span class="hljs-title function_">navigateTo</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/detail/detail?id=<span class="hljs-subst">${id}</span>`</span>,
      <span class="hljs-attr">complete</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// 导航完成后重置状态</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">isNavigating</span>: <span class="hljs-literal">false</span> });
        }, <span class="hljs-number">500</span>);
      },
    });
  },
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-title function_">navigateToDetail</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-keyword">const</span> { id } = e.<span class="hljs-property">currentTarget</span>.<span class="hljs-property">dataset</span>;

    <span class="hljs-comment">// 没有防止重复点击的机制</span>
    wx.<span class="hljs-title function_">navigateTo</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/detail/detail?id=<span class="hljs-subst">${id}</span>`</span>,
    });
  },
});
</code></pre>
  <h3 id="全局对象访问规范">全局对象访问规范</h3>
  <p><strong>规则</strong>: 访问全局 app 实例应使用 getApp()而非直接引用</p>
  <p><strong>说明</strong>: 使用 getApp()可以确保在正确的生命周期中访问全局实例，避免在实例未初始化时引发错误。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 获取全局数据</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">getApp</span>();
  <span class="hljs-keyword">return</span> app.<span class="hljs-property">globalData</span>.<span class="hljs-property">userInfo</span>;
}

<span class="hljs-comment">// 更新全局数据</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateUserInfo</span>(<span class="hljs-params">userInfo</span>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">getApp</span>();
  app.<span class="hljs-property">globalData</span>.<span class="hljs-property">userInfo</span> = userInfo;
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 直接引用app对象，可能在app未初始化完成时出错</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> app.<span class="hljs-property">globalData</span>.<span class="hljs-property">userInfo</span>;
}
</code></pre>
  <h3 id="使用-selectivequery-代替选择器">使用 selectiveQuery 代替选择器</h3>
  <p><strong>规则</strong>: 推荐使用组件内置的选择器查询</p>
  <p><strong>说明</strong>: 在组件中使用内置选择器可以确保查询限定在组件作用域内，避免全局选择可能带来的问题。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">getElementSize</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 在组件内使用</span>
      <span class="hljs-keyword">const</span> query = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createSelectorQuery</span>();
      query.<span class="hljs-title function_">select</span>(<span class="hljs-string">&#x27;.my-class&#x27;</span>).<span class="hljs-title function_">boundingClientRect</span>();
      query.<span class="hljs-title function_">exec</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res[<span class="hljs-number">0</span>].<span class="hljs-property">width</span>, res[<span class="hljs-number">0</span>].<span class="hljs-property">height</span>);
      });
    },
  },
});

<span class="hljs-comment">// 在页面中指定组件上下文</span>
<span class="hljs-title class_">Page</span>({
  <span class="hljs-title function_">getComponentSize</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> query = wx.<span class="hljs-title function_">createSelectorQuery</span>().<span class="hljs-title function_">in</span>(<span class="hljs-variable language_">this</span>);
    query.<span class="hljs-title function_">select</span>(<span class="hljs-string">&#x27;.component-class&#x27;</span>).<span class="hljs-title function_">boundingClientRect</span>();
    query.<span class="hljs-title function_">exec</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res[<span class="hljs-number">0</span>].<span class="hljs-property">width</span>, res[<span class="hljs-number">0</span>].<span class="hljs-property">height</span>);
    });
  },
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">getElementSize</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 不限定组件作用域的选择器查询</span>
      <span class="hljs-keyword">const</span> query = wx.<span class="hljs-title function_">createSelectorQuery</span>();
      query.<span class="hljs-title function_">select</span>(<span class="hljs-string">&#x27;.my-class&#x27;</span>).<span class="hljs-title function_">boundingClientRect</span>();
      query.<span class="hljs-title function_">exec</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
        <span class="hljs-comment">// 可能选择到页面上其他组件的同名元素</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res[<span class="hljs-number">0</span>].<span class="hljs-property">width</span>, res[<span class="hljs-number">0</span>].<span class="hljs-property">height</span>);
      });
    },
  },
});
</code></pre>
  <h2 id="api-调用规范续">API 调用规范（续）</h2>
  <h3 id="页面路由参数解析">页面路由参数解析</h3>
  <p><strong>规则</strong>: 页面参数应进行安全解析</p>
  <p><strong>说明</strong>: 安全地解析页面参数，为参数提供默认值可以避免因参数缺失而导致的错误。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-comment">// 使用ES6解构并提供默认值</span>
    <span class="hljs-keyword">const</span> { id = <span class="hljs-string">&#x27;&#x27;</span>, type = <span class="hljs-string">&#x27;default&#x27;</span>, page = <span class="hljs-string">&#x27;1&#x27;</span> } = options || {};

    <span class="hljs-comment">// 将字符串类型的数字转换为实际数字类型</span>
    <span class="hljs-keyword">const</span> pageNum = <span class="hljs-built_in">parseInt</span>(page, <span class="hljs-number">10</span>);

    <span class="hljs-comment">// 使用处理后的安全参数</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadData</span>(id, type, pageNum);
  },
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-comment">// 直接使用可能不存在的参数</span>
    <span class="hljs-keyword">const</span> id = options.<span class="hljs-property">id</span>;
    <span class="hljs-keyword">const</span> type = options.<span class="hljs-property">type</span>;

    <span class="hljs-comment">// 如果id不存在，可能导致程序错误</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadData</span>(id, type);
  },
});
</code></pre>
  <hr>
  <h2 id="数据绑定规范">数据绑定规范</h2>
  <h3 id="数据绑定使用-setdata-规范">数据绑定使用 setData 规范</h3>
  <p><strong>规则</strong>: setData 应当合并调用而非频繁单独调用</p>
  <p><strong>说明</strong>: 频繁调用 setData 会导致多次重新渲染，影响性能。应尽可能合并多个状态更新为一个 setData 调用。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 合并多个数据更新</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
  <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">list</span>: newList,
  <span class="hljs-attr">hasMore</span>: newList.<span class="hljs-property">length</span> === <span class="hljs-variable constant_">PAGE_SIZE</span>,
  <span class="hljs-attr">currentPage</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">currentPage</span> + <span class="hljs-number">1</span>,
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 多次独立调用setData</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">list</span>: newList });
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">hasMore</span>: newList.<span class="hljs-property">length</span> === <span class="hljs-variable constant_">PAGE_SIZE</span> });
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">currentPage</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">currentPage</span> + <span class="hljs-number">1</span> });
</code></pre>
  <h3 id="避免在循环中使用-setdata">避免在循环中使用 setData</h3>
  <p><strong>规则</strong>: 循环中不应调用 setData</p>
  <p><strong>说明</strong>: 在循环中调用 setData 会导致频繁的 UI 更新，严重影响性能。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title function_">handleItemsUpdate</span>(<span class="hljs-params">items</span>) {
  <span class="hljs-comment">// 先在循环中处理数据</span>
  <span class="hljs-keyword">const</span> updatedList = <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">slice</span>();

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; items.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> index = updatedList.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === items[i].<span class="hljs-property">id</span>);
    <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {
      updatedList[index] = { ...updatedList[index], ...items[i] };
    }
  }

  <span class="hljs-comment">// 一次性更新</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">list</span>: updatedList });
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title function_">handleItemsUpdate</span>(<span class="hljs-params">items</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; items.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">list</span>.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === items[i].<span class="hljs-property">id</span>);
    <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {
      <span class="hljs-comment">// 循环中调用setData，影响性能</span>
      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`list[<span class="hljs-subst">${index}</span>]`</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        [key]: { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">list</span>[index], ...items[i] }
      });
    }
  }
}
</code></pre>
  <h3 id="数据路径访问规范">数据路径访问规范</h3>
  <p><strong>规则</strong>: 使用数据路径表达式访问嵌套数据</p>
  <p><strong>说明</strong>: 直接通过数据路径更新嵌套数据，可以避免创建整个对象副本，提高性能。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 直接更新嵌套属性</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
  <span class="hljs-string">&#x27;userInfo.name&#x27;</span>: <span class="hljs-string">&#x27;New Name&#x27;</span>,
  <span class="hljs-string">&#x27;userInfo.age&#x27;</span>: <span class="hljs-number">25</span>,
  <span class="hljs-string">&#x27;settings.theme&#x27;</span>: <span class="hljs-string">&#x27;dark&#x27;</span>,
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 创建整个对象的副本来更新嵌套属性</span>
<span class="hljs-keyword">const</span> userInfo = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">userInfo</span> };
userInfo.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;New Name&#x27;</span>;
userInfo.<span class="hljs-property">age</span> = <span class="hljs-number">25</span>;

<span class="hljs-keyword">const</span> settings = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">settings</span> };
settings.<span class="hljs-property">theme</span> = <span class="hljs-string">&#x27;dark&#x27;</span>;

<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
  <span class="hljs-attr">userInfo</span>: userInfo,
  <span class="hljs-attr">settings</span>: settings,
});
</code></pre>
  <h3 id="请求防抖">请求防抖</h3>
  <p><strong>规则</strong>: 用户输入相关的请求应使用防抖</p>
  <p><strong>说明</strong>: 在用户输入过程中应用防抖机制，避免频繁发送请求，浪费网络资源和服务器资源。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">import</span> { debounce } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../utils/debounce&#x27;</span>;

<span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">keyword</span>: <span class="hljs-string">&#x27;&#x27;</span>,
  },

  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 创建防抖搜索函数</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">debouncedSearch</span> = <span class="hljs-title function_">debounce</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">search</span>, <span class="hljs-number">300</span>);
  },

  <span class="hljs-title function_">onInput</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-keyword">const</span> keyword = e.<span class="hljs-property">detail</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ keyword });

    <span class="hljs-comment">// 使用防抖处理搜索请求</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">debouncedSearch</span>(keyword);
  },

  <span class="hljs-title function_">search</span>(<span class="hljs-params">keyword</span>) {
    <span class="hljs-keyword">if</span> (!keyword) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// 发送搜索请求</span>
    wx.<span class="hljs-title function_">request</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/search&#x27;</span>,
      <span class="hljs-attr">data</span>: { keyword },
      <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">searchResults</span>: res.<span class="hljs-property">data</span>.<span class="hljs-property">results</span> });
      },
    });
  },
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">keyword</span>: <span class="hljs-string">&#x27;&#x27;</span>,
  },

  <span class="hljs-title function_">onInput</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-keyword">const</span> keyword = e.<span class="hljs-property">detail</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ keyword });

    <span class="hljs-comment">// 每次输入都立即发送请求，没有防抖</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">search</span>(keyword);
  },

  <span class="hljs-title function_">search</span>(<span class="hljs-params">keyword</span>) {
    <span class="hljs-keyword">if</span> (!keyword) <span class="hljs-keyword">return</span>;

    wx.<span class="hljs-title function_">request</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/search&#x27;</span>,
      <span class="hljs-attr">data</span>: { keyword },
      <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">searchResults</span>: res.<span class="hljs-property">data</span>.<span class="hljs-property">results</span> });
      },
    });
  },
});
</code></pre>
  <hr>
  <h2 id="性能优化规范">性能优化规范</h2>
  <h3 id="组件样式隔离">组件样式隔离</h3>
  <p><strong>规则</strong>: 组件应使用样式隔离</p>
  <p><strong>说明</strong>: 样式隔离可以防止组件样式被外部环境影响，也防止组件样式影响到页面其他元素。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">options</span>: {
    <span class="hljs-comment">// 启用样式隔离</span>
    <span class="hljs-attr">styleIsolation</span>: <span class="hljs-string">&#x27;isolated&#x27;</span>,
    <span class="hljs-comment">// 如需使用全局样式，可以设置：</span>
    <span class="hljs-comment">// addGlobalClass: true</span>
  },

  <span class="hljs-comment">// 组件其他属性...</span>
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Component</span>({
  <span class="hljs-comment">// 未指定样式隔离选项，可能导致样式冲突</span>
  <span class="hljs-comment">// 组件其他属性...</span>
});
</code></pre>
  <h3 id="wxs-性能优化">wxs 性能优化</h3>
  <p><strong>规则</strong>: 使用 wxs 处理频繁更新的视图逻辑</p>
  <p><strong>说明</strong>: WXS 执行在视图层，可以避免频繁的逻辑层和视图层通信，提高性能。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- price-format.wxs --&gt;</span>
<span class="hljs-comment">&lt;!--
module.exports = {
  format: function(price) {
    if (typeof price !== &#x27;number&#x27;) {
      return &#x27;0.00&#x27;;
    }
    return price.toFixed(2);
  }
}
--&gt;</span>

<span class="hljs-comment">&lt;!-- 页面中使用 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">wxs</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../../utils/price-format.wxs&quot;</span> <span class="hljs-attr">module</span>=<span class="hljs-string">&quot;priceFormat&quot;</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{products}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;product&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;price&quot;</span>&gt;</span>¥{{priceFormat.format(item.price)}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 在逻辑层处理格式化逻辑 --&gt;</span>
<span class="hljs-comment">&lt;!--
Page({
  data: {
    formattedPrices: []
  },
  updatePrices: function(prices) {
    const formattedPrices = prices.map(price =&gt; price.toFixed(2));
    this.setData({ formattedPrices });
  }
})
--&gt;</span>

<span class="hljs-comment">&lt;!-- 页面中使用 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{products}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;product&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;price&quot;</span>&gt;</span>¥{{formattedPrices[index]}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h3 id="避免频繁创建新对象">避免频繁创建新对象</h3>
  <p><strong>规则</strong>: setData 时避免频繁创建新对象</p>
  <p><strong>说明</strong>: 在定时器等频繁执行的场景中，频繁创建新对象会增加内存压力和 GC 频率，影响性能。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">timer</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">progress</span>: {
      <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span>,
    },
  },

  <span class="hljs-title function_">startTimer</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timerInterval</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// 只更新必要的字段，而不是整个对象</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-string">&#x27;progress.value&#x27;</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">progress</span>.<span class="hljs-property">value</span> + <span class="hljs-number">1</span>,
      });

      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">progress</span>.<span class="hljs-property">value</span> &gt;= <span class="hljs-number">100</span>) {
        <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timerInterval</span>);
      }
    }, <span class="hljs-number">100</span>);
  },
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">timer</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">progress</span>: {
      <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span>,
    },
  },

  <span class="hljs-title function_">startTimer</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timerInterval</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// 每次都创建完整的新对象</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">progress</span>: {
          <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">progress</span>.<span class="hljs-property">value</span> + <span class="hljs-number">1</span>,
          <span class="hljs-attr">color</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">progress</span>.<span class="hljs-property">color</span>,
        },
      });

      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">progress</span>.<span class="hljs-property">value</span> &gt;= <span class="hljs-number">100</span>) {
        <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timerInterval</span>);
      }
    }, <span class="hljs-number">100</span>);
  },
});
</code></pre>
  <h3 id="优化条件渲染">优化条件渲染</h3>
  <p><strong>规则</strong>: 长列表条件渲染优化</p>
  <p><strong>说明</strong>: 在视图层进行条件过滤会导致不必要的性能消耗，应在数据层面提前过滤。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-comment">// 提前过滤数据</span>
    <span class="hljs-attr">visibleItems</span>: []
  },

  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchData</span>();
  },

  <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 假设从API获取了原始数据</span>
    <span class="hljs-keyword">const</span> originalList = [...];

    <span class="hljs-comment">// 在数据层面进行过滤</span>
    <span class="hljs-keyword">const</span> visibleItems = originalList.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">visible</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ visibleItems });
  }
});
</code></pre>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 直接渲染已过滤的数据 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{visibleItems}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">items</span>: []
  },

  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchData</span>();
  },

  <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 直接设置原始数据</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">items</span>: [...] });
  }
});
</code></pre>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 在视图层进行过滤 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{items}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{item.visible}}&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h3 id="优化滚动区域">优化滚动区域</h3>
  <p><strong>规则</strong>: 长列表应使用优化的滚动区域</p>
  <p><strong>说明</strong>: 为滚动区域添加优化配置，可以提高长列表的滚动性能和用户体验。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">scroll-view</span>
  <span class="hljs-attr">scroll-y</span>
  <span class="hljs-attr">scroll-with-animation</span>
  <span class="hljs-attr">enable-back-to-top</span>
  <span class="hljs-attr">scroll-anchoring</span>
  <span class="hljs-attr">enhanced</span>=<span class="hljs-string">&quot;{{true}}&quot;</span>
  <span class="hljs-attr">bounces</span>=<span class="hljs-string">&quot;{{false}}&quot;</span>
  <span class="hljs-attr">show-scrollbar</span>=<span class="hljs-string">&quot;{{false}}&quot;</span>
  <span class="hljs-attr">bindscrolltolower</span>=<span class="hljs-string">&quot;onLoadMore&quot;</span>
&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">scroll-view</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">scroll-view</span> <span class="hljs-attr">scroll-y</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span> {{item.name}} <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">scroll-view</span>&gt;</span>
</code></pre>
  <h3 id="图片资源优化">图片资源优化</h3>
  <p><strong>规则</strong>: 图片资源应使用 CDN 或云存储路径</p>
  <p><strong>说明</strong>: 使用 CDN 或云存储可以减小小程序包体积，加快加载速度，同时能够动态更新图片而不需要重新发布小程序。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 使用CDN路径 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.example.com/images/logo.png&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 使用云存储路径 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;cloud://test-env.7465-test-env/images/banner.jpg&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 使用本地图片路径，会增加小程序包体积 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/images/logo.png&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">image</span>&gt;</span>
</code></pre>
  <h3 id="页面生命周期销毁资源">页面生命周期销毁资源</h3>
  <p><strong>规则</strong>: 页面销毁时应清理定时器和事件监听</p>
  <p><strong>说明</strong>: 未清理的定时器和事件监听会导致内存泄漏或意外行为。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">refreshInterval</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">eventHandler</span>: <span class="hljs-literal">null</span>,
  },

  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 设置定时器</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshInterval</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshData</span>();
    }, <span class="hljs-number">60000</span>);

    <span class="hljs-comment">// 添加事件监听</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandler</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Event received:&#x27;</span>, res);
    };
    wx.<span class="hljs-title function_">onLocationChange</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandler</span>);
  },

  <span class="hljs-title function_">onUnload</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 清理定时器</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshInterval</span>) {
      <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshInterval</span>);
    }

    <span class="hljs-comment">// 移除事件监听</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandler</span>) {
      wx.<span class="hljs-title function_">offLocationChange</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandler</span>);
    }
  },
});
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title class_">Page</span>({
  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 设置定时器但未在onUnload中清理</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshInterval</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshData</span>();
    }, <span class="hljs-number">60000</span>);

    <span class="hljs-comment">// 添加事件监听但未移除</span>
    wx.<span class="hljs-title function_">onLocationChange</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Event received:&#x27;</span>, res);
    });
  },

  <span class="hljs-comment">// 缺少onUnload函数清理资源</span>
});
</code></pre>
  <hr>
  <h2 id="代码质量规范">代码质量规范</h2>
  <h3 id="函数长度限制">函数长度限制</h3>
  <p><strong>规则</strong>: 函数不应超过 50 行，超过时考虑拆分</p>
  <p><strong>说明</strong>: 保持函数简短可以提高代码可读性和可维护性，使函数职责单一明确。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 主函数，调用多个职责单一的子函数</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processOrder</span>(<span class="hljs-params">order</span>) {
  <span class="hljs-title function_">validateOrder</span>(order);
  <span class="hljs-title function_">calculateTotal</span>(order);
  <span class="hljs-title function_">applyDiscount</span>(order);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatOrderResponse</span>(order);
}

<span class="hljs-comment">// 拆分的子函数，各自负责单一功能</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">validateOrder</span>(<span class="hljs-params">order</span>) {
  <span class="hljs-comment">// 验证逻辑...</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculateTotal</span>(<span class="hljs-params">order</span>) {
  <span class="hljs-comment">// 计算总价逻辑...</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">applyDiscount</span>(<span class="hljs-params">order</span>) {
  <span class="hljs-comment">// 应用折扣逻辑...</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatOrderResponse</span>(<span class="hljs-params">order</span>) {
  <span class="hljs-comment">// 格式化返回数据...</span>
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 单个过长的函数，职责不明确</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processOrder</span>(<span class="hljs-params">order</span>) {
  <span class="hljs-comment">// 验证部分</span>
  <span class="hljs-keyword">if</span> (!order.<span class="hljs-property">items</span> || !order.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;订单不能为空&#x27;</span>);
  }

  <span class="hljs-keyword">if</span> (!order.<span class="hljs-property">userId</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;用户ID不能为空&#x27;</span>);
  }

  <span class="hljs-comment">// 计算总价部分</span>
  <span class="hljs-keyword">let</span> total = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; order.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> item = order.<span class="hljs-property">items</span>[i];
    total += item.<span class="hljs-property">price</span> * item.<span class="hljs-property">quantity</span>;
  }

  <span class="hljs-comment">// 折扣计算部分</span>
  <span class="hljs-keyword">let</span> discount = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (total &gt; <span class="hljs-number">100</span>) {
    discount = total * <span class="hljs-number">0.1</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (total &gt; <span class="hljs-number">50</span>) {
    discount = total * <span class="hljs-number">0.05</span>;
  }

  <span class="hljs-comment">// 更多逻辑...（函数继续延伸）</span>

  <span class="hljs-comment">// 返回格式化数据</span>
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">orderId</span>: order.<span class="hljs-property">id</span>,
    <span class="hljs-attr">total</span>: total - discount,
    <span class="hljs-attr">discount</span>: discount,
    <span class="hljs-comment">// 更多字段...</span>
  };
}
</code></pre>
  <h3 id="条件判断简化">条件判断简化</h3>
  <p><strong>规则</strong>: 复杂条件判断应提取为命名良好的变量或函数</p>
  <p><strong>说明</strong>: 通过提取条件判断为有意义的变量名，可以提高代码可读性和自解释性。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">canUserAccess</span>(<span class="hljs-params">user, resource</span>) {
  <span class="hljs-comment">// 提取复杂条件为有意义的变量</span>
  <span class="hljs-keyword">const</span> isAuthenticated = user &amp;&amp; user.<span class="hljs-property">token</span> &amp;&amp; user.<span class="hljs-property">status</span> === <span class="hljs-string">&#x27;active&#x27;</span>;
  <span class="hljs-keyword">const</span> hasPermission = user.<span class="hljs-property">permissions</span>.<span class="hljs-title function_">includes</span>(resource.<span class="hljs-property">type</span>);
  <span class="hljs-keyword">const</span> isResourceAvailable =
    resource.<span class="hljs-property">status</span> === <span class="hljs-string">&#x27;published&#x27;</span> ||
    (resource.<span class="hljs-property">status</span> === <span class="hljs-string">&#x27;limited&#x27;</span> &amp;&amp; resource.<span class="hljs-property">allowedUsers</span>.<span class="hljs-title function_">includes</span>(user.<span class="hljs-property">id</span>));

  <span class="hljs-keyword">return</span> isAuthenticated &amp;&amp; hasPermission &amp;&amp; isResourceAvailable;
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">canUserAccess</span>(<span class="hljs-params">user, resource</span>) {
  <span class="hljs-comment">// 复杂的内联条件判断，难以阅读和理解</span>
  <span class="hljs-keyword">if</span> (
    user &amp;&amp;
    user.<span class="hljs-property">token</span> &amp;&amp;
    user.<span class="hljs-property">status</span> === <span class="hljs-string">&#x27;active&#x27;</span> &amp;&amp;
    user.<span class="hljs-property">permissions</span>.<span class="hljs-title function_">includes</span>(resource.<span class="hljs-property">type</span>) &amp;&amp;
    (resource.<span class="hljs-property">status</span> === <span class="hljs-string">&#x27;published&#x27;</span> ||
      (resource.<span class="hljs-property">status</span> === <span class="hljs-string">&#x27;limited&#x27;</span> &amp;&amp; resource.<span class="hljs-property">allowedUsers</span>.<span class="hljs-title function_">includes</span>(user.<span class="hljs-property">id</span>)))
  ) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
  <h3 id="防止-this-丢失">防止 this 丢失</h3>
  <p><strong>规则</strong>: 回调函数中防止 this 指向丢失</p>
  <p><strong>说明</strong>: 在 JavaScript 中，函数内的 this 指向取决于调用方式，在回调函数中 this 可能不再指向组件实例。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 方法1：使用箭头函数</span>
<span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
  wx.<span class="hljs-title function_">request</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
    <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
      <span class="hljs-comment">// 箭头函数不绑定自己的this，会捕获上下文中的this</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">list</span>: res.<span class="hljs-property">data</span> });
    }
  });
}

<span class="hljs-comment">// 方法2：提前保存this引用</span>
<span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> that = <span class="hljs-variable language_">this</span>;
  wx.<span class="hljs-title function_">request</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
    <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) {
      <span class="hljs-comment">// 使用保存的that引用</span>
      that.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">list</span>: res.<span class="hljs-property">data</span> });
    }
  });
}

<span class="hljs-comment">// 方法3：使用bind</span>
<span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
  wx.<span class="hljs-title function_">request</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
    <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">list</span>: res.<span class="hljs-property">data</span> });
    }.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
  });
}
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-title function_">fetchData</span>(<span class="hljs-params"></span>) {
  wx.<span class="hljs-title function_">request</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
    <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) {
      <span class="hljs-comment">// 在普通函数中，this不再指向组件实例，会导致错误</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">list</span>: res.<span class="hljs-property">data</span> });
    }
  });
}
</code></pre>
  <h3 id="禁止-console-语句">禁止 console 语句</h3>
  <p><strong>规则</strong>: 生产代码中不应有 console 语句</p>
  <p><strong>说明</strong>: 生产环境中的 console 语句可能暴露敏感信息，影响性能，应该在发布前移除或条件包装。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 方法1：使用环境变量条件判断</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">logDebug</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">&#x27;production&#x27;</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);
  }
}

<span class="hljs-comment">// 方法2：使用日志工具库，可在生产环境禁用</span>
<span class="hljs-keyword">const</span> logger = {
  <span class="hljs-attr">debug</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">if</span> (__DEV__) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;[DEBUG]&#x27;</span>, message);
    }
  },
  <span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) {
    <span class="hljs-comment">// 错误可能需要在生产环境也记录</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;[ERROR]&#x27;</span>, message);
    <span class="hljs-comment">// 可以发送到错误监控服务</span>
  },
};

logger.<span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;这是调试信息&#x27;</span>);
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 直接使用console语句</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processData</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Processing data:&#x27;</span>, data); <span class="hljs-comment">// 生产环境不应该有这句</span>

  <span class="hljs-comment">// 处理逻辑...</span>

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Data processed&#x27;</span>); <span class="hljs-comment">// 生产环境不应该有这句</span>
}
</code></pre>
  <h3 id="使用-es6-解构">使用 ES6 解构</h3>
  <p><strong>规则</strong>: 鼓励使用 ES6 解构简化代码</p>
  <p><strong>说明</strong>: ES6 解构可以使代码更简洁，减少重复引用，提高可读性。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 对象解构</span>
<span class="hljs-keyword">const</span> { name, age, address } = user;

<span class="hljs-comment">// 数组解构</span>
<span class="hljs-keyword">const</span> [first, second, ...rest] = items;

<span class="hljs-comment">// 函数参数解构</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processUser</span>(<span class="hljs-params">{ name, age, isVIP = <span class="hljs-literal">false</span> }</span>) {
  <span class="hljs-comment">// 使用解构的参数</span>
}

<span class="hljs-comment">// 嵌套解构</span>
<span class="hljs-keyword">const</span> {
  <span class="hljs-attr">company</span>: { <span class="hljs-attr">name</span>: companyName, <span class="hljs-attr">address</span>: companyAddress },
} = userData;
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-comment">// 不使用解构，代码冗长</span>
<span class="hljs-keyword">const</span> name = user.<span class="hljs-property">name</span>;
<span class="hljs-keyword">const</span> age = user.<span class="hljs-property">age</span>;
<span class="hljs-keyword">const</span> address = user.<span class="hljs-property">address</span>;

<span class="hljs-comment">// 不使用数组解构</span>
<span class="hljs-keyword">const</span> first = items[<span class="hljs-number">0</span>];
<span class="hljs-keyword">const</span> second = items[<span class="hljs-number">1</span>];
<span class="hljs-keyword">const</span> rest = items.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>);
</code></pre>
  <h3 id="推荐使用模板字符串">推荐使用模板字符串</h3>
  <p><strong>规则</strong>: 字符串拼接应使用模板字符串</p>
  <p><strong>说明</strong>: 模板字符串提供更清晰、更易读的字符串插值方式。</p>
  <p><strong>正确示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">const</span> name = <span class="hljs-string">&#x27;Alice&#x27;</span>;
<span class="hljs-keyword">const</span> greeting = <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>!`</span>;

<span class="hljs-keyword">const</span> item = { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Product&#x27;</span> };
<span class="hljs-keyword">const</span> url = <span class="hljs-string">`/pages/detail/detail?id=<span class="hljs-subst">${item.id}</span>&amp;name=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(item.name)}</span>`</span>;

<span class="hljs-comment">// 多行字符串</span>
<span class="hljs-keyword">const</span> html = <span class="hljs-string">`
  &lt;view class=&quot;container&quot;&gt;
    &lt;text&gt;<span class="hljs-subst">${title}</span>&lt;/text&gt;
    &lt;text&gt;<span class="hljs-subst">${content}</span>&lt;/text&gt;
  &lt;/view&gt;
`</span>;
</code></pre>
  <p><strong>错误示例</strong>:</p>
  <pre><code class="language-javascript"><span class="hljs-keyword">const</span> name = <span class="hljs-string">&#x27;Alice&#x27;</span>;
<span class="hljs-keyword">const</span> greeting = <span class="hljs-string">&#x27;Hello &#x27;</span> + name + <span class="hljs-string">&#x27;!&#x27;</span>;

<span class="hljs-keyword">const</span> item = { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Product&#x27;</span> };
<span class="hljs-keyword">const</span> url = <span class="hljs-string">&#x27;/pages/detail/detail?id=&#x27;</span> + item.<span class="hljs-property">id</span> + <span class="hljs-string">&#x27;&amp;name=&#x27;</span> + <span class="hljs-built_in">encodeURIComponent</span>(item.<span class="hljs-property">name</span>);
</code></pre>
  <hr>
  <h2 id="最佳实践">最佳实践</h2>
  <p>以下是一些整合了上述规则的微信小程序开发最佳实践示例。</p>
  <h3 id="页面示例">页面示例</h3>
  <pre><code class="language-javascript"><span class="hljs-comment">// 导入部分 - 按照规定顺序</span>
<span class="hljs-keyword">import</span> regeneratorRuntime <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;regenerator-runtime&#x27;</span>;
<span class="hljs-keyword">import</span> { wxPromise } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../utils/wx-promise&#x27;</span>;
<span class="hljs-keyword">import</span> { debounce, throttle } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../utils/performance&#x27;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">API_URL</span>, <span class="hljs-variable constant_">PAGE_SIZE</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../config/constants&#x27;</span>;
<span class="hljs-keyword">import</span> userService <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../services/userService&#x27;</span>;

<span class="hljs-comment">// 常量定义</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_TIMEOUT</span> = <span class="hljs-number">5000</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REFRESH_INTERVAL</span> = <span class="hljs-number">60000</span>;

<span class="hljs-title class_">Page</span>({
  <span class="hljs-comment">// 数据</span>
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">list</span>: [],
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">pageNum</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">hasMore</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">keyword</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    <span class="hljs-attr">isNavigating</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
  },

  <span class="hljs-comment">// 生命周期函数</span>
  <span class="hljs-title function_">onLoad</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-comment">// 安全解析参数</span>
    <span class="hljs-keyword">const</span> { id = <span class="hljs-string">&#x27;&#x27;</span>, type = <span class="hljs-string">&#x27;all&#x27;</span> } = options || {};
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageId</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageType</span> = type;

    <span class="hljs-comment">// 初始化防抖函数</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">debouncedSearch</span> = <span class="hljs-title function_">debounce</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">search</span>, <span class="hljs-number">300</span>);

    <span class="hljs-comment">// 加载初始数据</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadData</span>();

    <span class="hljs-comment">// 设置刷新定时器</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshTimer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshData</span>();
    }, <span class="hljs-variable constant_">REFRESH_INTERVAL</span>);
  },

  <span class="hljs-title function_">onShow</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 页面显示时的逻辑</span>
  },

  <span class="hljs-title function_">onHide</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 页面隐藏时的逻辑</span>
  },

  <span class="hljs-title function_">onUnload</span>(<span class="hljs-params"></span>) {
    <span class="hljs-comment">// 清理资源</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshTimer</span>) {
      <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshTimer</span>);
    }
  },

  <span class="hljs-title function_">onPullDownRefresh</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshData</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      wx.<span class="hljs-title function_">stopPullDownRefresh</span>();
    });
  },

  <span class="hljs-title function_">onReachBottom</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">hasMore</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">loading</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadMoreData</span>();
    }
  },

  <span class="hljs-comment">// 事件处理函数</span>
  <span class="hljs-title function_">handleItemTap</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">isNavigating</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> { id } = e.<span class="hljs-property">currentTarget</span>.<span class="hljs-property">dataset</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">isNavigating</span>: <span class="hljs-literal">true</span> });

    wxPromise
      .<span class="hljs-title function_">navigateTo</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/detail/detail?id=<span class="hljs-subst">${id}</span>`</span>,
      })
      .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        wx.<span class="hljs-title function_">showToast</span>({
          <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;页面跳转失败&#x27;</span>,
          <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;none&#x27;</span>,
        });
      })
      .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">isNavigating</span>: <span class="hljs-literal">false</span> });
        }, <span class="hljs-number">500</span>);
      });
  },

  <span class="hljs-title function_">handleSearchInput</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-keyword">const</span> keyword = e.<span class="hljs-property">detail</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ keyword });
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">debouncedSearch</span>(keyword);
  },

  <span class="hljs-comment">// 业务方法</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadData</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });

      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> wxPromise.<span class="hljs-title function_">request</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>/api/items`</span>,
        <span class="hljs-attr">data</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageType</span>,
          <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">size</span>: <span class="hljs-variable constant_">PAGE_SIZE</span>,
        },
        <span class="hljs-attr">timeout</span>: <span class="hljs-variable constant_">DEFAULT_TIMEOUT</span>,
      });

      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">list</span>: res.<span class="hljs-property">data</span>.<span class="hljs-property">items</span>,
        <span class="hljs-attr">pageNum</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">hasMore</span>: res.<span class="hljs-property">data</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span> === <span class="hljs-variable constant_">PAGE_SIZE</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      });
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;数据加载失败，请重试&#x27;</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      });
    }
  },

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadMoreData</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">loading</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span> });

      <span class="hljs-keyword">const</span> nextPage = <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">pageNum</span> + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> wxPromise.<span class="hljs-title function_">request</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>/api/items`</span>,
        <span class="hljs-attr">data</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageType</span>,
          <span class="hljs-attr">page</span>: nextPage,
          <span class="hljs-attr">size</span>: <span class="hljs-variable constant_">PAGE_SIZE</span>,
        },
      });

      <span class="hljs-comment">// 合并数据</span>
      <span class="hljs-keyword">const</span> newList = [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">list</span>, ...res.<span class="hljs-property">data</span>.<span class="hljs-property">items</span>];

      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">list</span>: newList,
        <span class="hljs-attr">pageNum</span>: nextPage,
        <span class="hljs-attr">hasMore</span>: res.<span class="hljs-property">data</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span> === <span class="hljs-variable constant_">PAGE_SIZE</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      });
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;加载更多数据失败&#x27;</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      });
    }
  },

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">refreshData</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadData</span>();
  },

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">keyword</span>) {
    <span class="hljs-keyword">if</span> (!keyword) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadData</span>();
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });

      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> wxPromise.<span class="hljs-title function_">request</span>({
        <span class="hljs-attr">url</span>: <span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>/api/search`</span>,
        <span class="hljs-attr">data</span>: { keyword },
      });

      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">list</span>: res.<span class="hljs-property">data</span>.<span class="hljs-property">items</span>,
        <span class="hljs-attr">hasMore</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      });
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;搜索失败，请重试&#x27;</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      });
    }
  },
});
</code></pre>
  <h3 id="组件示例">组件示例</h3>
  <pre><code class="language-javascript"><span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">properties</span>: {
    <span class="hljs-attr">title</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;&#x27;</span>,
    },
    <span class="hljs-attr">items</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,
      <span class="hljs-attr">value</span>: [],
    },
    <span class="hljs-attr">loading</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-literal">false</span>,
    },
  },

  <span class="hljs-attr">options</span>: {
    <span class="hljs-attr">styleIsolation</span>: <span class="hljs-string">&#x27;isolated&#x27;</span>,
    <span class="hljs-attr">multipleSlots</span>: <span class="hljs-literal">true</span>,
  },

  <span class="hljs-attr">externalClasses</span>: [<span class="hljs-string">&#x27;custom-class&#x27;</span>],

  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">currentIndex</span>: <span class="hljs-number">0</span>,
  },

  <span class="hljs-attr">lifetimes</span>: {
    <span class="hljs-title function_">attached</span>(<span class="hljs-params"></span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
    },
    <span class="hljs-title function_">detached</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 清理工作</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">disconnect</span>();
      }
    },
  },

  <span class="hljs-attr">pageLifetimes</span>: {
    <span class="hljs-title function_">show</span>(<span class="hljs-params"></span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">needRefresh</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refresh</span>();
      }
    },
  },
  <span class="hljs-attr">observers</span>: {
    <span class="hljs-attr">items</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">items</span>) {
      <span class="hljs-keyword">if</span> (items.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processItems</span>(items);
      }
    },
  },

  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) {
      <span class="hljs-comment">// 初始化逻辑</span>
      <span class="hljs-keyword">const</span> query = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createSelectorQuery</span>();
      query.<span class="hljs-title function_">select</span>(<span class="hljs-string">&#x27;.component-root&#x27;</span>).<span class="hljs-title function_">boundingClientRect</span>();
      query.<span class="hljs-title function_">exec</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (res &amp;&amp; res[<span class="hljs-number">0</span>]) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">componentSize</span>: res[<span class="hljs-number">0</span>] });
        }
      });
    },

    <span class="hljs-title function_">processItems</span>(<span class="hljs-params">items</span>) {
      <span class="hljs-comment">// 数据处理逻辑</span>
      <span class="hljs-keyword">const</span> processedItems = items.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({
        ...item,
        <span class="hljs-attr">displayName</span>: item.<span class="hljs-property">name</span> || <span class="hljs-string">&#x27;未命名项&#x27;</span>,
        <span class="hljs-attr">statusClass</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getStatusClass</span>(item.<span class="hljs-property">status</span>),
      }));

      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({
        <span class="hljs-attr">processedItems</span>: processedItems,
      });
    },

    <span class="hljs-title function_">getStatusClass</span>(<span class="hljs-params">status</span>) {
      <span class="hljs-comment">// 返回不同状态对应的样式类名</span>
      <span class="hljs-keyword">const</span> statusMap = {
        <span class="hljs-attr">active</span>: <span class="hljs-string">&#x27;status-active&#x27;</span>,
        <span class="hljs-attr">pending</span>: <span class="hljs-string">&#x27;status-pending&#x27;</span>,
        <span class="hljs-attr">completed</span>: <span class="hljs-string">&#x27;status-completed&#x27;</span>,
        <span class="hljs-attr">failed</span>: <span class="hljs-string">&#x27;status-failed&#x27;</span>,
      };

      <span class="hljs-keyword">return</span> statusMap[status] || <span class="hljs-string">&#x27;status-default&#x27;</span>;
    },

    <span class="hljs-title function_">handleItemTap</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-keyword">const</span> { index } = e.<span class="hljs-property">currentTarget</span>.<span class="hljs-property">dataset</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">currentIndex</span>: index });

      <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">processedItems</span>[index];
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;item-tap&#x27;</span>, { item });
    },

    <span class="hljs-title function_">refresh</span>(<span class="hljs-params"></span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>({ <span class="hljs-attr">needRefresh</span>: <span class="hljs-literal">false</span> });
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerEvent</span>(<span class="hljs-string">&#x27;refresh&#x27;</span>);
    },
  },
});
</code></pre>
  <h3 id="wxml-和-wxss-示例">WXML 和 WXSS 示例</h3>
  <h4 id="wxml-页面示例">WXML 页面示例</h4>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 页面WXML --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 搜索区域 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;search-area&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入搜索关键词&quot;</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;{{keyword}}&quot;</span>
      <span class="hljs-attr">bindinput</span>=<span class="hljs-string">&quot;handleSearchInput&quot;</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;search-input&quot;</span>
    /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;search-btn&quot;</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;handleSearch&quot;</span>&gt;</span>搜索<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 使用wxs处理格式化 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">wxs</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../../utils/formatter.wxs&quot;</span> <span class="hljs-attr">module</span>=<span class="hljs-string">&quot;fmt&quot;</span> /&gt;</span>

  <span class="hljs-comment">&lt;!-- 列表内容，处理空状态 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">block</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{list.length &gt; 0}}&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;list-container&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">view</span>
        <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{list}}&quot;</span>
        <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;list-item&quot;</span>
        <span class="hljs-attr">hover-class</span>=<span class="hljs-string">&quot;item-hover&quot;</span>
        <span class="hljs-attr">hover-stay-time</span>=<span class="hljs-string">&quot;100&quot;</span>
        <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;handleItemTap&quot;</span>
        <span class="hljs-attr">data-id</span>=<span class="hljs-string">&quot;{{item.id}}&quot;</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-image&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;{{item.imageUrl}}&quot;</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">&quot;aspectFill&quot;</span> <span class="hljs-attr">lazy-load</span>=<span class="hljs-string">&quot;{{true}}&quot;</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-content&quot;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-title&quot;</span>&gt;</span>{{item.title}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-desc&quot;</span>&gt;</span>{{item.description}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-price&quot;</span>&gt;</span>{{fmt.formatPrice(item.price)}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 加载更多状态 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;loading-more&quot;</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{loading}}&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;loading-icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">text</span>&gt;</span>加载中...<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;no-more&quot;</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{!hasMore &amp;&amp; !loading}}&quot;</span>&gt;</span> 已加载全部内容 <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">block</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 空状态展示 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty-state&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty-image&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.example.com/images/empty.png&quot;</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">&quot;heightFix&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty-text&quot;</span>&gt;</span>{{error || &#x27;暂无数据&#x27;}}<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{error}}&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;loadData&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;retry-btn&quot;</span>&gt;</span>
      重新加载
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h4 id="wxss-样式示例">WXSS 样式示例</h4>
  <pre><code class="language-css"><span class="hljs-comment">/* 页面样式 */</span>
<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20</span>rpx;
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f6f6f6</span>;
}

<span class="hljs-comment">/* 搜索区域 */</span>
<span class="hljs-selector-class">.search-area</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20</span>rpx;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">16</span>rpx;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8</span>rpx;
}

<span class="hljs-selector-class">.search-input</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">72</span>rpx;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20</span>rpx;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1</span>rpx solid <span class="hljs-number">#eee</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28</span>rpx;
}

<span class="hljs-selector-class">.search-btn</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">120</span>rpx;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">72</span>rpx;
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">16</span>rpx;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#07c160</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28</span>rpx;
}

<span class="hljs-comment">/* 列表样式 */</span>
<span class="hljs-selector-class">.list-container</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.list-item</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20</span>rpx;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1</span>rpx solid <span class="hljs-number">#f5f5f5</span>;
}

<span class="hljs-selector-class">.item-hover</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f9f9f9</span>;
}

<span class="hljs-selector-class">.item-image</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">160</span>rpx;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">160</span>rpx;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#eee</span>;
}

<span class="hljs-selector-class">.item-content</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20</span>rpx;
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.item-title</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">32</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">white-space</span>: nowrap;
  <span class="hljs-attribute">text-overflow</span>: ellipsis;
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.item-desc</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">26</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#666</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">text-overflow</span>: ellipsis;
  <span class="hljs-attribute">display</span>: -webkit-box;
  -webkit-line-clamp: <span class="hljs-number">2</span>;
  -webkit-box-orient: vertical;
}

<span class="hljs-selector-class">.item-price</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">32</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#ff5500</span>;
  <span class="hljs-attribute">font-weight</span>: bold;
}

<span class="hljs-comment">/* 加载状态 */</span>
<span class="hljs-selector-class">.loading-more</span>,
<span class="hljs-selector-class">.no-more</span> {
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">30</span>rpx <span class="hljs-number">0</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">26</span>rpx;
}

<span class="hljs-selector-class">.loading-icon</span> {
  <span class="hljs-attribute">display</span>: inline-block;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">40</span>rpx;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">40</span>rpx;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">4</span>rpx solid <span class="hljs-number">#f3f3f3</span>;
  <span class="hljs-attribute">border-top</span>: <span class="hljs-number">4</span>rpx solid <span class="hljs-number">#666</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">10</span>rpx;
  <span class="hljs-attribute">animation</span>: spin <span class="hljs-number">1s</span> linear infinite;
}

<span class="hljs-keyword">@keyframes</span> spin {
  <span class="hljs-number">0%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
  }
  <span class="hljs-number">100%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
  }
}

<span class="hljs-comment">/* 空状态 */</span>
<span class="hljs-selector-class">.empty-state</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">100</span>rpx <span class="hljs-number">0</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: column;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
}

<span class="hljs-selector-class">.empty-image</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">200</span>rpx;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">200</span>rpx;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30</span>rpx;
}

<span class="hljs-selector-class">.empty-text</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30</span>rpx;
}

<span class="hljs-selector-class">.retry-btn</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">26</span>rpx;
}
</code></pre>
  <h3 id="组件-wxml-和-wxss-示例">组件 WXML 和 WXSS 示例</h3>
  <h4 id="组件-wxml-示例">组件 WXML 示例</h4>
  <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 组件WXML --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;component-root custom-class&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 标题区域，使用命名插槽 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;header&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;header-right&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 加载状态 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;loading-mask&quot;</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{loading}}&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;loading-icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;loading-text&quot;</span>&gt;</span>加载中...<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 内容区域 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">block</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">&quot;{{processedItems &amp;&amp; processedItems.length &gt; 0}}&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">view</span>
        <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;{{processedItems}}&quot;</span>
        <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;id&quot;</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item {{currentIndex === index ? &#x27;item-active&#x27; : &#x27;&#x27;}}&quot;</span>
        <span class="hljs-attr">hover-class</span>=<span class="hljs-string">&quot;item-hover&quot;</span>
        <span class="hljs-attr">hover-stay-time</span>=<span class="hljs-string">&quot;100&quot;</span>
        <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;handleItemTap&quot;</span>
        <span class="hljs-attr">data-index</span>=<span class="hljs-string">&quot;{{index}}&quot;</span>
      &gt;</span>
        <span class="hljs-comment">&lt;!-- 状态标识 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;status-badge {{item.statusClass}}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- 项目内容 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-main&quot;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-name&quot;</span>&gt;</span>{{item.displayName}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item-meta&quot;</span>&gt;</span>{{item.meta || &#x27;&#x27;}}<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- 使用命名插槽允许自定义项目右侧内容 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;item-right&quot;</span> <span class="hljs-attr">data</span>=<span class="hljs-string">&quot;{{item}}&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">block</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 空状态 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">wx:else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;empty&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;empty-default&quot;</span>&gt;</span>暂无数据<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 底部区域 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;footer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
</code></pre>
  <h4 id="组件-wxss-示例">组件 WXSS 示例</h4>
  <pre><code class="language-css"><span class="hljs-comment">/* 组件样式 */</span>
<span class="hljs-selector-class">.component-root</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12</span>rpx;
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2</span>rpx <span class="hljs-number">10</span>rpx <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.05</span>);
}

<span class="hljs-comment">/* 标题区域 */</span>
<span class="hljs-selector-class">.header</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: space-between;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">24</span>rpx;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1</span>rpx solid <span class="hljs-number">#f5f5f5</span>;
}

<span class="hljs-selector-class">.title</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">32</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;
}

<span class="hljs-comment">/* 内容区域 */</span>
<span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100</span>rpx;
}

<span class="hljs-comment">/* 项目样式 */</span>
<span class="hljs-selector-class">.item</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">24</span>rpx;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1</span>rpx solid <span class="hljs-number">#f5f5f5</span>;
}

<span class="hljs-selector-class">.item</span><span class="hljs-selector-pseudo">:last-child</span> {
  <span class="hljs-attribute">border-bottom</span>: none;
}

<span class="hljs-selector-class">.item-hover</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f9f9f9</span>;
}

<span class="hljs-selector-class">.item-active</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f0f8ff</span>;
}

<span class="hljs-selector-class">.status-badge</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">16</span>rpx;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">16</span>rpx;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">20</span>rpx;
}

<span class="hljs-selector-class">.status-active</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#07c160</span>;
}

<span class="hljs-selector-class">.status-pending</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#faa307</span>;
}

<span class="hljs-selector-class">.status-completed</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0077ff</span>;
}

<span class="hljs-selector-class">.status-failed</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff3b30</span>;
}

<span class="hljs-selector-class">.status-default</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#999</span>;
}

<span class="hljs-selector-class">.item-main</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.item-name</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8</span>rpx;
  <span class="hljs-attribute">white-space</span>: nowrap;
  <span class="hljs-attribute">text-overflow</span>: ellipsis;
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.item-meta</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;
}

<span class="hljs-comment">/* 加载状态 */</span>
<span class="hljs-selector-class">.loading-mask</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.8</span>);
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: column;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">10</span>;
}

<span class="hljs-selector-class">.loading-icon</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">60</span>rpx;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">60</span>rpx;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">6</span>rpx solid <span class="hljs-number">#f3f3f3</span>;
  <span class="hljs-attribute">border-top</span>: <span class="hljs-number">6</span>rpx solid <span class="hljs-number">#07c160</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20</span>rpx;
  <span class="hljs-attribute">animation</span>: spin <span class="hljs-number">1s</span> linear infinite;
}

<span class="hljs-selector-class">.loading-text</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#666</span>;
}

<span class="hljs-keyword">@keyframes</span> spin {
  <span class="hljs-number">0%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
  }
  <span class="hljs-number">100%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
  }
}

<span class="hljs-comment">/* 空状态 */</span>
<span class="hljs-selector-class">.empty</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">60</span>rpx <span class="hljs-number">0</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
}

<span class="hljs-selector-class">.empty-default</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28</span>rpx;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;
}

<span class="hljs-comment">/* 底部区域 */</span>
<span class="hljs-selector-class">.footer</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">24</span>rpx;
  <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1</span>rpx solid <span class="hljs-number">#f5f5f5</span>;
}
</code></pre>
  <h3 id="工具函数示例">工具函数示例</h3>
  <h4 id="promise-封装工具">Promise 封装工具</h4>
  <pre><code class="language-javascript"><span class="hljs-comment">// utils/wx-promise.js</span>

<span class="hljs-comment">/**
 * 将wx原生API转换为Promise形式
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} fn 微信API方法
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} Promise化的API方法
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">promisify</span> = fn =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">options = {}</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-title function_">fn</span>({
        ...options,
        <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(res);
        },
        <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
          <span class="hljs-title function_">reject</span>(err);
        },
      });
    });
  };
};

<span class="hljs-comment">// 常用API Promise化</span>
<span class="hljs-keyword">const</span> wxPromise = {
  <span class="hljs-attr">request</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">request</span>),
  <span class="hljs-attr">navigateTo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">navigateTo</span>),
  <span class="hljs-attr">redirectTo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">redirectTo</span>),
  <span class="hljs-attr">switchTab</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">switchTab</span>),
  <span class="hljs-attr">reLaunch</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">reLaunch</span>),
  <span class="hljs-attr">showToast</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">showToast</span>),
  <span class="hljs-attr">showLoading</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">showLoading</span>),
  <span class="hljs-attr">showModal</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">showModal</span>),
  <span class="hljs-attr">login</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">login</span>),
  <span class="hljs-attr">getUserInfo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getUserInfo</span>),
  <span class="hljs-attr">getImageInfo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getImageInfo</span>),
  <span class="hljs-attr">getSystemInfo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getSystemInfo</span>),
  <span class="hljs-attr">getLocation</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getLocation</span>),
  <span class="hljs-attr">uploadFile</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">uploadFile</span>),
  <span class="hljs-attr">downloadFile</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">downloadFile</span>),
  <span class="hljs-attr">setStorage</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">setStorage</span>),
  <span class="hljs-attr">getStorage</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getStorage</span>),
  <span class="hljs-attr">removeStorage</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">removeStorage</span>),
  <span class="hljs-attr">clearStorage</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">clearStorage</span>),
  <span class="hljs-attr">getStorageInfo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getStorageInfo</span>),
  <span class="hljs-attr">chooseImage</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">chooseImage</span>),
  <span class="hljs-attr">chooseVideo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">chooseVideo</span>),
  <span class="hljs-attr">chooseLocation</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">chooseLocation</span>),
  <span class="hljs-attr">openLocation</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">openLocation</span>),
  <span class="hljs-attr">saveImageToPhotosAlbum</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">saveImageToPhotosAlbum</span>),
  <span class="hljs-attr">previewImage</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">previewImage</span>),
  <span class="hljs-attr">connectSocket</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">connectSocket</span>),
  <span class="hljs-attr">closeSocket</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">closeSocket</span>),
  <span class="hljs-attr">makePhoneCall</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">makePhoneCall</span>),
  <span class="hljs-attr">scanCode</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">scanCode</span>),
  <span class="hljs-attr">requestPayment</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">requestPayment</span>),
  <span class="hljs-attr">authorize</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">authorize</span>),
  <span class="hljs-attr">openSetting</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">openSetting</span>),
  <span class="hljs-attr">getSetting</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getSetting</span>),
  <span class="hljs-attr">checkSession</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">checkSession</span>),
  <span class="hljs-attr">getShareInfo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getShareInfo</span>),
  <span class="hljs-attr">startPullDownRefresh</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">startPullDownRefresh</span>),
  <span class="hljs-attr">stopPullDownRefresh</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">stopPullDownRefresh</span>),
  <span class="hljs-attr">setClipboardData</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">setClipboardData</span>),
  <span class="hljs-attr">getClipboardData</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getClipboardData</span>),
  <span class="hljs-attr">addPhoneContact</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">addPhoneContact</span>),
  <span class="hljs-attr">getFileInfo</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getFileInfo</span>),
  <span class="hljs-attr">saveFile</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">saveFile</span>),
  <span class="hljs-attr">removeFile</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">removeFile</span>),
  <span class="hljs-attr">getWeRunData</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">getWeRunData</span>),
  <span class="hljs-attr">canvasToTempFilePath</span>: <span class="hljs-title function_">promisify</span>(wx.<span class="hljs-property">canvasToTempFilePath</span>),
};

<span class="hljs-keyword">export</span> { wxPromise, promisify };
</code></pre>
  <h4 id="防抖节流工具">防抖节流工具</h4>
  <pre><code class="language-javascript"><span class="hljs-comment">// utils/performance.js</span>

<span class="hljs-comment">/**
 * 防抖函数
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} fn 需要防抖的函数
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} delay 延迟时间，单位毫秒
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} 防抖处理后的函数
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, delay = <span class="hljs-number">300</span></span>) {
  <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;

    <span class="hljs-keyword">if</span> (timer) {
      <span class="hljs-built_in">clearTimeout</span>(timer);
    }

    timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      fn.<span class="hljs-title function_">apply</span>(context, args);
      timer = <span class="hljs-literal">null</span>;
    }, delay);
  };
}

<span class="hljs-comment">/**
 * 节流函数
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} fn 需要节流的函数
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} threshold 阈值，单位毫秒
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} 节流处理后的函数
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">throttle</span>(<span class="hljs-params">fn, threshold = <span class="hljs-number">300</span></span>) {
  <span class="hljs-keyword">let</span> last = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

    <span class="hljs-keyword">if</span> (now - last &gt;= threshold) {
      <span class="hljs-keyword">if</span> (timer) {
        <span class="hljs-built_in">clearTimeout</span>(timer);
        timer = <span class="hljs-literal">null</span>;
      }

      last = now;
      fn.<span class="hljs-title function_">apply</span>(context, args);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!timer) {
      timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        last = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        fn.<span class="hljs-title function_">apply</span>(context, args);
        timer = <span class="hljs-literal">null</span>;
      }, threshold - (now - last));
    }
  };
}

<span class="hljs-comment">/**
 * 防抖和节流结合
 * 连续触发时使用节流，停止触发时使用防抖
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} fn 处理函数
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} delay 防抖延迟
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} threshold 节流阈值
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} 处理后的函数
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">throttleAndDebounce</span>(<span class="hljs-params">fn, delay = <span class="hljs-number">300</span>, threshold = <span class="hljs-number">300</span></span>) {
  <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">let</span> last = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

    <span class="hljs-keyword">if</span> (now - last &gt;= threshold) {
      <span class="hljs-keyword">if</span> (timer) {
        <span class="hljs-built_in">clearTimeout</span>(timer);
        timer = <span class="hljs-literal">null</span>;
      }

      last = now;
      fn.<span class="hljs-title function_">apply</span>(context, args);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (timer) {
        <span class="hljs-built_in">clearTimeout</span>(timer);
      }

      timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        last = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        fn.<span class="hljs-title function_">apply</span>(context, args);
        timer = <span class="hljs-literal">null</span>;
      }, delay);
    }
  };
}
</code></pre>
  <h4 id="格式化工具wxs">格式化工具（WXS）</h4>
  <pre><code class="language-javascript"><span class="hljs-comment">// utils/formatter.wxs</span>

<span class="hljs-comment">/**
 * 格式化价格
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} price 价格
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} prefix 前缀，默认为¥
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">String</span>} 格式化后的价格字符串
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatPrice</span>(<span class="hljs-params">price, prefix</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> price !== <span class="hljs-string">&#x27;number&#x27;</span>) {
    <span class="hljs-keyword">return</span> (prefix || <span class="hljs-string">&#x27;¥&#x27;</span>) + <span class="hljs-string">&#x27;0.00&#x27;</span>;
  }

  <span class="hljs-keyword">return</span> (prefix || <span class="hljs-string">&#x27;¥&#x27;</span>) + price.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
}

<span class="hljs-comment">/**
 * 格式化日期时间
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} timestamp 时间戳
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} format 格式化模式，默认为yyyy-MM-dd
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">String</span>} 格式化后的日期时间字符串
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatDateTime</span>(<span class="hljs-params">timestamp, format</span>) {
  <span class="hljs-keyword">if</span> (!timestamp) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;
  }

  <span class="hljs-keyword">var</span> date = <span class="hljs-title function_">getDate</span>(timestamp);
  format = format || <span class="hljs-string">&#x27;yyyy-MM-dd&#x27;</span>;

  <span class="hljs-keyword">var</span> year = date.<span class="hljs-title function_">getFullYear</span>();
  <span class="hljs-keyword">var</span> month = date.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">var</span> day = date.<span class="hljs-title function_">getDate</span>();
  <span class="hljs-keyword">var</span> hour = date.<span class="hljs-title function_">getHours</span>();
  <span class="hljs-keyword">var</span> minute = date.<span class="hljs-title function_">getMinutes</span>();
  <span class="hljs-keyword">var</span> second = date.<span class="hljs-title function_">getSeconds</span>();

  <span class="hljs-comment">// 补零函数</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">return</span> n &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + n : <span class="hljs-string">&#x27;&#x27;</span> + n;
  }

  <span class="hljs-keyword">return</span> format
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;yyyy&#x27;</span>, year)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;MM&#x27;</span>, <span class="hljs-title function_">pad</span>(month))
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;dd&#x27;</span>, <span class="hljs-title function_">pad</span>(day))
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;HH&#x27;</span>, <span class="hljs-title function_">pad</span>(hour))
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;mm&#x27;</span>, <span class="hljs-title function_">pad</span>(minute))
    .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;ss&#x27;</span>, <span class="hljs-title function_">pad</span>(second));
}

<span class="hljs-comment">/**
 * 格式化文件大小
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} size 文件大小（字节）
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">String</span>} 格式化后的文件大小
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatFileSize</span>(<span class="hljs-params">size</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> size !== <span class="hljs-string">&#x27;number&#x27;</span> || size &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0 B&#x27;</span>;
  }

  <span class="hljs-keyword">var</span> units = [<span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;KB&#x27;</span>, <span class="hljs-string">&#x27;MB&#x27;</span>, <span class="hljs-string">&#x27;GB&#x27;</span>, <span class="hljs-string">&#x27;TB&#x27;</span>, <span class="hljs-string">&#x27;PB&#x27;</span>];
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (size &gt;= <span class="hljs-number">1024</span> &amp;&amp; i &lt; units.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
    size = size / <span class="hljs-number">1024</span>;
    i++;
  }

  <span class="hljs-keyword">return</span> size.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>) + <span class="hljs-string">&#x27; &#x27;</span> + units[i];
}

<span class="hljs-comment">/**
 * 格式化数量
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} num 数量
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">String</span>} 格式化后的数量
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatNumber</span>(<span class="hljs-params">num</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> num !== <span class="hljs-string">&#x27;number&#x27;</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0&#x27;</span>;
  }

  <span class="hljs-keyword">if</span> (num &gt;= <span class="hljs-number">10000</span>) {
    <span class="hljs-keyword">return</span> (num / <span class="hljs-number">10000</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">1</span>) + <span class="hljs-string">&#x27;w&#x27;</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (num &gt;= <span class="hljs-number">1000</span>) {
    <span class="hljs-keyword">return</span> (num / <span class="hljs-number">1000</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">1</span>) + <span class="hljs-string">&#x27;k&#x27;</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> num.<span class="hljs-title function_">toString</span>();
  }
}

<span class="hljs-comment">/**
 * 文本截断
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} str 原始文本
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} maxLength 最大长度
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} suffix 后缀
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">String</span>} 截断后的文本
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">truncate</span>(<span class="hljs-params">str, maxLength, suffix</span>) {
  <span class="hljs-keyword">if</span> (!str) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>;
  }

  maxLength = maxLength || <span class="hljs-number">10</span>;
  suffix = suffix || <span class="hljs-string">&#x27;...&#x27;</span>;

  <span class="hljs-keyword">if</span> (str.<span class="hljs-property">length</span> &lt;= maxLength) {
    <span class="hljs-keyword">return</span> str;
  }

  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, maxLength) + suffix;
}

<span class="hljs-comment">// 导出工具函数</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">formatPrice</span>: formatPrice,
  <span class="hljs-attr">formatDateTime</span>: formatDateTime,
  <span class="hljs-attr">formatFileSize</span>: formatFileSize,
  <span class="hljs-attr">formatNumber</span>: formatNumber,
  <span class="hljs-attr">truncate</span>: truncate,
};
</code></pre>
  <h2 id="项目结构示例">项目结构示例</h2>
  <p>以下是一个符合规范的微信小程序项目目录结构示例：</p>
  <pre><code>my-mini-program/
├── .cursorrules                // Cursor规则文件
├── project.config.json         // 项目配置文件
├── miniprogram/                // 小程序源代码
│   ├── app.js                  // 应用入口
│   ├── app.json                // 应用配置
│   ├── app.wxss                // 应用全局样式
│   ├── sitemap.json            // 小程序索引配置
│   ├── utils/                  // 工具库
│   │   ├── wx-promise.js       // Promise封装
│   │   ├── performance.js      // 性能优化工具
│   │   ├── formatter.wxs       // 格式化工具(WXS)
│   │   ├── validator.js        // 数据验证工具
│   │   └── logger.js           // 日志工具
│   ├── config/                 // 配置文件
│   │   ├── index.js            // 配置入口
│   │   ├── api.js              // API配置
│   │   └── constants.js        // 常量定义
│   ├── services/               // 服务层
│   │   ├── http.js             // 网络请求服务
│   │   ├── user-service.js     // 用户相关服务
│   │   └── order-service.js    // 订单相关服务
│   ├── components/             // 组件
│   │   ├── card/               // 卡片组件
│   │   │   ├── card.js         // 组件逻辑
│   │   │   ├── card.json       // 组件配置
│   │   │   ├── card.wxml       // 组件模板
│   │   │   └── card.wxss       // 组件样式
│   │   └── tab-bar/            // 底部标签栏
│   │       ├── tab-bar.js
│   │       ├── tab-bar.json
│   │       ├── tab-bar.wxml
│   │       └── tab-bar.wxss
│   ├── pages/                  // 页面
│   │   ├── index/              // 首页
│   │   │   ├── index.js        // 页面逻辑
│   │   │   ├── index.json      // 页面配置
│   │   │   ├── index.wxml      // 页面模板
│   │   │   └── index.wxss      // 页面样式
│   │   ├── detail/             // 详情页
│   │   ├── user/               // 用户页
│   │   └── cart/               // 购物车页
│   └── images/                 // 本地图片资源
├── cloudfunctions/             // 云函数
└── README.md                   // 项目说明文档
</code></pre>
  <h2 id="总结">总结</h2>
  <p>本规范从以下几个方面详细阐述了微信小程序开发的最佳实践：</p>
  <ol>
    <li>
      <p><strong>代码结构规范</strong>：明确了页面、组件文件的结构和属性顺序，使代码更加清晰易读。</p>
    </li>
    <li>
      <p><strong>命名规范</strong>：统一了变量、常量、函数和 CSS 类的命名规则，提高代码的一致性和可读性。</p>
    </li>
    <li>
      <p><strong>WXML 视图层规范</strong>：规范了 wx:for、wx:if 等指令的使用方式，以及处理空状态、图片懒加载等视图层最佳实践。</p>
    </li>
    <li>
      <p><strong>API 调用规范</strong>：推荐使用 Promise 封装微信 API，统一处理错误，防止重复页面跳转等问题。</p>
    </li>
    <li>
      <p><strong>数据绑定规范</strong>：优化 setData 的使用方式，避免频繁调用或在循环中调用，使用数据路径表达式更新嵌套数据。</p>
    </li>
    <li>
      <p><strong>性能优化规范</strong>：通过组件样式隔离、WXS 优化、避免频繁创建新对象等措施提升性能。</p>
    </li>
    <li>
      <p><strong>代码质量规范</strong>：限制函数长度，简化条件判断，防止 this 丢失，鼓励使用 ES6 特性等，提高代码质量。</p>
    </li>
  </ol>
  <p>遵循这些规范可以帮助开发团队更高效地协作，提高代码质量，为用户提供更好的小程序体验。同时，这些规范也需要结合团队实际情况进行适当调整和完善，形成适合自己团队的开发规范。</p>
  <hr>
  <p><strong>附录：常用工具函数</strong></p>
  <p>本文档提供了一系列实用的工具函数，包括：</p>
  <ol>
    <li>Promise 化的微信 API 封装</li>
    <li>防抖和节流函数</li>
    <li>WXS 格式化工具</li>
  </ol>
  <p>这些工具函数可以直接复制到项目中使用，有助于提高开发效率和代码质量。</p>

  <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>

</body>

</html>